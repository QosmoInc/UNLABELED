# Configuration for INRIA Person Detection Patch Training
# This configuration generates patches that reduce person detection confidence

trainer:
  type: InriaPatchTrainer

dataset:
  type: inria
  img_dir: inria/Train/pos
  lab_dir: inria/Train/pos/yolo-labels
  max_labels: 14

model:
  cfgfile: cfg/yolov2.cfg
  weightfile: weights/yolov2.weights

patch:
  size: 600
  name: person_inria_patch
  initial_type: gray  # Options: gray, random, image
  style_image: imgs/210831_meisai+.jpg
  content_image: imgs/210831_meisai+.jpg

training:
  batch_size: 8
  epochs: 300
  learning_rate: 0.03
  num_workers: 4

losses:
  detection_weight: 1.0
  adain_weight: 0.0
  content_weight: 5.0
  tv_weight: 0.5
  tv_max: 0.165

target:
  class_id: 0  # person class in COCO dataset
  objective: minimize

wandb:
  enabled: true
  project: adversarial-patch
  tags:
    - person-detection
    - inria-dataset
  notes: Training adversarial patch to minimize person detection confidence
