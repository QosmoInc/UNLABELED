# Configuration for INRIA Person Detection Patch Training
# This configuration generates patches that reduce person detection confidence

trainer:
  type: InriaPatchTrainer

dataset:
  type: inria
  img_dir: inria/Train/pos
  lab_dir: inria/Train/pos/yolo-labels
  max_labels: 14

model:
  cfgfile: cfg/yolov2.cfg
  weightfile: weights/yolov2.weights

patch:
  size: 1024
  name: person_inria_patch
  initial_type: gray  # Options: gray, random, image
  # style_image: imgs/2025_11_22/01-1.jpg
  # content_image: imgs/2025_11_22/01-1.jpg
  # style_image: imgs/2025_11_22/01-2.jpg
  # content_image: imgs/2025_11_22/01-2.jpg
  style_image: imgs/2025_11_22/01-3.jpg
  content_image: imgs/2025_11_22/01-3.jpg
  # style_image: imgs/2025_11_22/02-1.jpg
  # content_image: imgs/2025_11_22/02-1.jpg
  # style_image: imgs/2025_11_22/02-2.jpg
  # content_image: imgs/2025_11_22/02-2.jpg
  # style_image: imgs/2025_11_22/02-3.jpg
  # content_image: imgs/2025_11_22/02-3.jpg
  # style_image: imgs/2025_11_22/03-1.jpg
  # content_image: imgs/2025_11_22/03-1.jpg
  # style_image: imgs/2025_11_22/03-2.jpg
  # content_image: imgs/2025_11_22/03-2.jpg
  # style_image: imgs/2025_11_22/03-3.jpg
  # content_image: imgs/2025_11_22/03-3.jpg

training:
  batch_size: 8
  epochs: 300
  learning_rate: 0.03
  num_workers: 4
  seed: 42  # Random seed for reproducibility (set to null for non-deterministic training)

losses:
  detection_weight: 1.0
  adain_weight: 0.0
  content_weight: 5.0
  tv_weight: 0.5
  tv_max: 0.165

target:
  class_id: 0  # person class in COCO dataset
  objective: minimize

wandb:
  enabled: true
  project: adversarial-patch
  tags:
    - person-detection
    - inria-dataset
  notes: Training adversarial patch to minimize person detection confidence
